import requests, os, time, socket, json

# Renkler
class Renk:
    YEÅÄ°L = '\033[92m'
    KIRMIZI = '\033[91m'
    SARI = '\033[93m'
    MAVÄ° = '\033[96m'
    BÄ°TÄ°R = '\033[0m'

# 50+ site listesi
siteler = {
    "GitHub": "https://github.com/{}",
    "Instagram": "https://www.instagram.com/{}",
    "Twitter": "https://twitter.com/{}",
    "Reddit": "https://www.reddit.com/user/{}",
    "TikTok": "https://www.tiktok.com/@{}",
    "Facebook": "https://www.facebook.com/{}",
    "Twitch": "https://www.twitch.tv/{}",
    "Pinterest": "https://www.pinterest.com/{}",
    "Steam": "https://steamcommunity.com/id/{}",
    "YouTube": "https://www.youtube.com/{}",
    "DeviantArt": "https://www.deviantart.com/{}",
    "Flickr": "https://www.flickr.com/people/{}",
    "Vimeo": "https://vimeo.com/{}",
    "SoundCloud": "https://soundcloud.com/{}",
    "Medium": "https://medium.com/@{}",
    "Disqus": "https://disqus.com/by/{}",
    "Spotify": "https://open.spotify.com/user/{}",
    "WordPress": "https://{}.wordpress.com",
    "Roblox": "https://www.roblox.com/user.aspx?username={}",
    "Replit": "https://replit.com/@{}",
    "Codepen": "https://codepen.io/{}",
    "BuyMeACoffee": "https://www.buymeacoffee.com/{}",
    "HackerOne": "https://hackerone.com/{}",
    "Trello": "https://trello.com/{}",
    "Kaggle": "https://www.kaggle.com/{}",
    "AskFM": "https://ask.fm/{}",
    "Ok.ru": "https://ok.ru/{}",
    "MyAnimeList": "https://myanimelist.net/profile/{}",
    "Last.fm": "https://www.last.fm/user/{}",
    "Behance": "https://www.behance.net/{}",
    "Gravatar": "https://en.gravatar.com/{}",
    "500px": "https://500px.com/{}",
    "ProductHunt": "https://www.producthunt.com/@{}",
    "Snapchat": "https://www.snapchat.com/add/{}",
    "Bandcamp": "https://{}.bandcamp.com",
    "Bitbucket": "https://bitbucket.org/{}",
    "Gitee": "https://gitee.com/{}",
    "Flipboard": "https://flipboard.com/@{}",
    "Canva": "https://www.canva.com/{}",
    "Fandom": "https://{}.fandom.com",
    "Pastebin": "https://pastebin.com/u/{}",
    "Strava": "https://www.strava.com/athletes/{}",
    "Letterboxd": "https://letterboxd.com/{}",
    "Sketchfab": "https://sketchfab.com/{}",
    "Ello": "https://ello.co/{}",
    "Unsplash": "https://unsplash.com/@{}",
    "Lichess": "https://lichess.org/@/{}",
    "Chess.com": "https://www.chess.com/member/{}",
    "Blogger": "https://{}.blogspot.com"
}

def temizle():
    os.system("cls" if os.name == "nt" else "clear")

def usercan():
    temizle()
    kullanici = input("ğŸ”¤ KullanÄ±cÄ± adÄ± gir: ").strip()
    if not kullanici: return
    print(Renk.MAVÄ° + f"\nğŸ” '{kullanici}' iÃ§in tarama baÅŸlÄ±yor...\n" + Renk.BÄ°TÄ°R)
    bulunanlar = []
    for isim, url in siteler.items():
        link = url.format(kullanici)
        try:
            r = requests.get(link, timeout=5)
            if r.status_code == 200:
                print(f"{Renk.YEÅÄ°L}[âœ“] {isim}: {link}{Renk.BÄ°TÄ°R}")
                bulunanlar.append(link)
            else:
                print(f"{Renk.KIRMIZI}[Ã—] {isim}{Renk.BÄ°TÄ°R}")
        except:
            print(f"{Renk.SARI}[!] {isim}: BaÄŸlantÄ± hatasÄ±{Renk.BÄ°TÄ°R}")
        time.sleep(0.1)
    if bulunanlar:
        with open(f"{kullanici}_bulunanlar.txt", "w") as f:
            f.write("\n".join(bulunanlar))
        print(Renk.MAVÄ° + f"\nğŸ“ '{kullanici}_bulunanlar.txt' dosyasÄ±na kaydedildi.\n" + Renk.BÄ°TÄ°R)
    input("â†©ï¸ MenÃ¼ye dÃ¶nmek iÃ§in Enter...")

def sitecheck():
    temizle()
    
    ip = input("ğŸ“¡ IP adresi gir: ").strip()
    try:
        veri = requests.get(f"http://ip-api.com/json/{ip}").json()
        if veri["status"] == "fail":
            print(Renk.KIRMIZI + "âŒ IP bilgisi alÄ±namadÄ±." + Renk.BÄ°TÄ°R)
            return
        print(Renk.MAVÄ° + f"\nğŸŒ Ãœlke: {veri['country']}, {veri['city']}")
        print(f"ğŸ“¡ IP: {veri['query']}")
        print(f"ğŸ¢ ISS: {veri['isp']}")
        print(f"ğŸ” VPN mi?: {'Evet' if any(x in veri['isp'].lower() for x in ['vpn','host','cloud']) else 'HayÄ±r'}" + Renk.BÄ°TÄ°R)
    except:
        print(Renk.KIRMIZI + "Hata oluÅŸtu." + Renk.BÄ°TÄ°R)
    input("\nâ†©ï¸ MenÃ¼ye dÃ¶nmek iÃ§in Enter...")
import requests

def header_analiz(url):
    print(f"\nğŸ” {url} adresine istek gÃ¶nderiliyor...\n")
    try:
        r = requests.get(url, timeout=7)
        headers = r.headers

        print("â¡ï¸ Header Bilgileri:")
        for k, v in headers.items():
            print(f"  {k}: {v}")

        print("\nâš ï¸ GÃ¼venlik KontrolÃ¼:")

        # Content-Security-Policy kontrolÃ¼
        csp = headers.get("Content-Security-Policy")
        if csp:
            print("âœ… Content-Security-Policy var.")
        else:
            print("âŒ Content-Security-Policy (CSP) bulunamadÄ±! XSS aÃ§Ä±ÄŸÄ± riski olabilir.")

        # X-XSS-Protection kontrolÃ¼
        x_xss = headers.get("X-XSS-Protection")
        if x_xss == "0":
            print("âš ï¸ X-XSS-Protection devre dÄ±ÅŸÄ± bÄ±rakÄ±lmÄ±ÅŸ (0). GÃ¼venlik riskli olabilir.")
        elif x_xss:
            print(f"âœ… X-XSS-Protection: {x_xss}")
        else:
            print("âŒ X-XSS-Protection header'Ä± yok. XSS savunmasÄ± zayÄ±f olabilir.")

        # Set-Cookie HttpOnly ve Secure kontrolÃ¼ (kÄ±smi kontrol)
        set_cookie = headers.get("Set-Cookie")
        if set_cookie:
            if "HttpOnly" in set_cookie and "Secure" in set_cookie:
                print("âœ… Set-Cookie'da HttpOnly ve Secure var.")
            else:
                print("âš ï¸ Set-Cookie'da HttpOnly veya Secure eksik olabilir.")
        else:
            print("âŒ Set-Cookie header'Ä± yok. Ã‡erez gÃ¼venliÄŸi sorgulanmalÄ±.")

        # Server bilgisi (versiyon bilgisi kontrolÃ¼)
        server = headers.get("Server")
        if server:
            if any(c in server.lower() for c in ["apache", "nginx", "iis", "tomcat"]):
                print(f"âš ï¸ Server bilgisi aÃ§Ä±k: {server}. Versiyon bilgisi olabilir, bu risk oluÅŸturabilir.")
            else:
                print(f"âœ… Server bilgisi maskelenmiÅŸ veya Ã¶zel: {server}")
        else:
            print("âœ… Server header'Ä± yok, iyi.")

        # Referrer-Policy kontrolÃ¼
        ref_policy = headers.get("Referrer-Policy")
        if ref_policy:
            print(f"âœ… Referrer-Policy: {ref_policy}")
        else:
            print("âš ï¸ Referrer-Policy yok. Veri sÄ±zÄ±ntÄ±sÄ± riski olabilir.")

        # HSTS kontrolÃ¼
        hsts = headers.get("Strict-Transport-Security")
        if hsts:
            print(f"âœ… HSTS aktif: {hsts}")
        else:
            print("âš ï¸ HSTS yok! HTTPS kullanÄ±mÄ± tam gÃ¼venli olmayabilir.")

        print("\nğŸ”š Analiz tamamlandÄ±.\n")

    except Exception as e:
        print(f"âŒ Hata oluÅŸtu: {e}")

# Ã–rnek kullanÄ±m:
# header_analiz("https://www.google.com")
def menu():
    while True:
        temizle()
        print(Renk.MAVÄ° + "=== GTX-L-NKSCANNER v2 ===\n" + Renk.BÄ°TÄ°R)
        print("1) Usercan (50+ site kullanÄ±cÄ± adÄ± taramasÄ±)")
        print("2) Site analiz aracÄ± (URL Ã¼zerinden)")
        print("3) IP analiz ve VPN kontrol")
        print("4) Ã‡Ä±kÄ±ÅŸ\n")
        secim = input("SeÃ§imin (1-4): ").strip()
        if secim == "1": usercan()
        elif secim == "2": sitecheck()
        elif secim == "3": ipanaliz()
        elif secim == "4":
            print("ğŸ‘‹ GÃ¶rÃ¼ÅŸÃ¼rÃ¼z kanka!")
            break
        else:
            print(Renk.KIRMIZI + "GeÃ§ersiz seÃ§im!" + Renk.BÄ°TÄ°R)
            time.sleep(1)

if __name__ == "__main__":
    menu()
